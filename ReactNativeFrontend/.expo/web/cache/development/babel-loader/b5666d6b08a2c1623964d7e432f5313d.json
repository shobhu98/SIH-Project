{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/cosentus/Documents/GitHub/SIH-Project/ReactNativeFrontend/node_modules/expo-pixi/lib/components/Signature.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { GLView } from 'expo-gl';\nimport PanResponder from \"react-native-web/dist/exports/PanResponder\";\nimport PixelRatio from \"react-native-web/dist/exports/PixelRatio\";\nimport { vec2 } from 'gl-matrix';\nimport PIXI from \"../Pixi\";\nimport { takeSnapshotAsync } from \"../utils\";\nimport { BezierPath, BezierProvider } from \"../core/signature\";\nglobal.__ExpoSignatureId = global.__ExpoSignatureId || 0;\nvar scale = PixelRatio.get();\n\nfunction scaled(nativeEvent) {\n  var out = vec2.fromValues(nativeEvent.locationX, nativeEvent.locationY);\n  vec2.scale(out, out, scale);\n  return out;\n}\n\nvar Signature = function (_React$Component) {\n  _inherits(Signature, _React$Component);\n\n  var _super = _createSuper(Signature);\n\n  function Signature(props, _context) {\n    var _this;\n\n    _classCallCheck(this, Signature);\n\n    _this = _super.call(this, props, _context);\n\n    _this._setupPanResponder = function () {\n      var onEnd = function onEnd(nativeEvent) {\n        _this.provider.addPointToSignature(scaled(nativeEvent), true);\n\n        _this.provider.reset();\n\n        setTimeout(function () {\n          return _this.props.onChange && _this.props.onChange(_this.renderer);\n        }, 1);\n      };\n\n      _this.panResponder = PanResponder.create({\n        onStartShouldSetResponder: function onStartShouldSetResponder() {\n          return true;\n        },\n        onStartShouldSetPanResponderCapture: function onStartShouldSetPanResponderCapture() {\n          return true;\n        },\n        onMoveShouldSetPanResponder: function onMoveShouldSetPanResponder(evt, gestureState) {\n          return true;\n        },\n        onPanResponderGrant: function onPanResponderGrant(_ref) {\n          var nativeEvent = _ref.nativeEvent;\n\n          _this._beginNewLine();\n\n          _this.provider.reset();\n\n          _this.provider.addPointToSignature(scaled(nativeEvent));\n        },\n        onPanResponderMove: function onPanResponderMove(_ref2) {\n          var nativeEvent = _ref2.nativeEvent;\n\n          _this.provider.addPointToSignature(scaled(nativeEvent));\n        },\n        onPanResponderRelease: function onPanResponderRelease(_ref3) {\n          var nativeEvent = _ref3.nativeEvent;\n          return onEnd(nativeEvent);\n        },\n        onPanResponderTerminate: function onPanResponderTerminate(_ref4) {\n          var nativeEvent = _ref4.nativeEvent;\n          return onEnd(nativeEvent);\n        }\n      });\n    };\n\n    _this._beginNewLine = function () {\n      _this.graphics = new PIXI.Graphics();\n\n      _this.stage.addChild(_this.graphics);\n    };\n\n    _this._drawPath = function (type, points, finalized) {\n      _this.graphicsTmp.clear();\n\n      var graphics = finalized ? _this.graphics : _this.graphicsTmp;\n      graphics.beginFill(_this.props.strokeColor);\n      graphics.lineStyle(1, _this.props.strokeColor, _this.props.strokeAlpha);\n      BezierPath[type](points, graphics);\n      graphics.endFill();\n\n      _this.renderer._update();\n    };\n\n    _this.shouldComponentUpdate = function () {\n      return false;\n    };\n\n    _this.undo = function () {\n      if (!_this.renderer) {\n        return null;\n      }\n\n      var children = _this.stage.children;\n\n      if (children.length > 0) {\n        var child = children[children.length - 1];\n\n        _this.stage.removeChild(child);\n\n        _this.renderer._update();\n\n        setTimeout(function () {\n          return _this.props.onChange && _this.props.onChange(_this.renderer);\n        }, 2);\n        return child;\n      }\n    };\n\n    _this.clear = function () {\n      _this.provider.reset();\n\n      if (!_this.renderer) {\n        return null;\n      }\n\n      if (_this.stage.children.length > 0) {\n        _this.stage.removeChildren();\n\n        _this.renderer._update();\n      }\n\n      return null;\n    };\n\n    _this.takeSnapshotAsync = function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return takeSnapshotAsync.apply(void 0, [_this.glView].concat(args));\n    };\n\n    _this.onContextCreate = function _callee(context) {\n      var getAttributes;\n      return _regeneratorRuntime.async(function _callee$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this.context = context;\n              _this.graphicsTmp = new PIXI.Graphics();\n              _this.stage = new PIXI.Container();\n\n              _this.stage.addChild(_this.graphicsTmp);\n\n              getAttributes = context.getContextAttributes || function () {\n                return {};\n              };\n\n              context.getContextAttributes = function () {\n                var contextAttributes = getAttributes();\n                return _objectSpread(_objectSpread({}, contextAttributes), {}, {\n                  stencil: true\n                });\n              };\n\n              _this.renderer = PIXI.autoDetectRenderer(context.drawingBufferWidth, context.drawingBufferHeight, {\n                context: context,\n                antialias: true,\n                backgroundColor: 0xffffff,\n                transparent: false,\n                autoStart: false\n              });\n\n              _this.renderer._update = function () {\n                _this.renderer.render(_this.stage);\n\n                context.endFrameEXP();\n              };\n\n              _this.props.onReady && _this.props.onReady(context);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.onLayout = function (_ref5) {\n      var _ref5$nativeEvent$lay = _ref5.nativeEvent.layout,\n          width = _ref5$nativeEvent$lay.width,\n          height = _ref5$nativeEvent$lay.height;\n\n      if (_this.renderer) {\n        var _scale = PixelRatio.get();\n\n        _this.renderer.resize(width * _scale, height * _scale);\n\n        _this.renderer._update();\n      }\n    };\n\n    _this.setRef = function (ref) {\n      _this.glView = ref;\n    };\n\n    _this.provider = new BezierProvider();\n\n    _this._setupPanResponder();\n\n    return _this;\n  }\n\n  _createClass(Signature, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      global.__ExpoSignatureId++;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._drawSub = this.provider.addListener(BezierProvider.EVENT_DRAW_PATH, this._drawPath);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._drawSub.remove();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(GLView, _extends({}, this.panResponder.panHandlers, {\n        onLayout: this.onLayout,\n        key: 'Expo.Signature-' + global.__ExpoSignatureId,\n        ref: this.setRef\n      }, this.props, {\n        onContextCreate: this.onContextCreate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 7\n        }\n      }));\n    }\n  }]);\n\n  return Signature;\n}(React.Component);\n\nexport { Signature as default };","map":{"version":3,"sources":["/Users/cosentus/Documents/GitHub/SIH-Project/ReactNativeFrontend/node_modules/expo-pixi/lib/components/Signature.js"],"names":["React","GLView","vec2","PIXI","takeSnapshotAsync","BezierPath","BezierProvider","global","__ExpoSignatureId","scale","PixelRatio","get","scaled","nativeEvent","out","fromValues","locationX","locationY","Signature","props","context","_setupPanResponder","onEnd","provider","addPointToSignature","reset","setTimeout","onChange","renderer","panResponder","PanResponder","create","onStartShouldSetResponder","onStartShouldSetPanResponderCapture","onMoveShouldSetPanResponder","evt","gestureState","onPanResponderGrant","_beginNewLine","onPanResponderMove","onPanResponderRelease","onPanResponderTerminate","graphics","Graphics","stage","addChild","_drawPath","type","points","finalized","graphicsTmp","clear","beginFill","strokeColor","lineStyle","strokeAlpha","endFill","_update","shouldComponentUpdate","undo","children","length","child","removeChild","removeChildren","args","glView","onContextCreate","Container","getAttributes","getContextAttributes","contextAttributes","stencil","autoDetectRenderer","drawingBufferWidth","drawingBufferHeight","antialias","backgroundColor","transparent","autoStart","render","endFrameEXP","onReady","onLayout","layout","width","height","resize","setRef","ref","_drawSub","addListener","EVENT_DRAW_PATH","remove","panHandlers","Component"],"mappings":";;;;;;;;;;;;;;;;;;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,SAAvB;;;AAEA,SAASC,IAAT,QAAqB,WAArB;AAEA,OAAOC,IAAP;AACA,SAASC,iBAAT;AACA,SAASC,UAAT,EAAqBC,cAArB;AAEAC,MAAM,CAACC,iBAAP,GAA2BD,MAAM,CAACC,iBAAP,IAA4B,CAAvD;AASA,IAAMC,KAAK,GAAGC,UAAU,CAACC,GAAX,EAAd;;AAEA,SAASC,MAAT,CAAgBC,WAAhB,EAA6B;AAC3B,MAAMC,GAAG,GAAGZ,IAAI,CAACa,UAAL,CAAgBF,WAAW,CAACG,SAA5B,EAAuCH,WAAW,CAACI,SAAnD,CAAZ;AACAf,EAAAA,IAAI,CAACO,KAAL,CAAWK,GAAX,EAAgBA,GAAhB,EAAqBL,KAArB;AACA,SAAOK,GAAP;AACD;;IAEoBI,S;;;;;AASnB,qBAAYC,KAAZ,EAAmBC,QAAnB,EAA4B;AAAA;;AAAA;;AAC1B,8BAAMD,KAAN,EAAaC,QAAb;;AAD0B,UAmB5BC,kBAnB4B,GAmBP,YAAM;AACzB,UAAMC,KAAK,GAAG,SAARA,KAAQ,CAAAT,WAAW,EAAI;AAC3B,cAAKU,QAAL,CAAcC,mBAAd,CAAkCZ,MAAM,CAACC,WAAD,CAAxC,EAAuD,IAAvD;;AACA,cAAKU,QAAL,CAAcE,KAAd;;AAEAC,QAAAA,UAAU,CAAC;AAAA,iBAAM,MAAKP,KAAL,CAAWQ,QAAX,IAAuB,MAAKR,KAAL,CAAWQ,QAAX,CAAoB,MAAKC,QAAzB,CAA7B;AAAA,SAAD,EAAkE,CAAlE,CAAV;AACD,OALD;;AAOA,YAAKC,YAAL,GAAoBC,YAAY,CAACC,MAAb,CAAoB;AACtCC,QAAAA,yBAAyB,EAAE;AAAA,iBAAM,IAAN;AAAA,SADW;AAEtCC,QAAAA,mCAAmC,EAAE;AAAA,iBAAM,IAAN;AAAA,SAFC;AAGtCC,QAAAA,2BAA2B,EAAE,qCAACC,GAAD,EAAMC,YAAN;AAAA,iBAAuB,IAAvB;AAAA,SAHS;AAItCC,QAAAA,mBAAmB,EAAE,mCAAqB;AAAA,cAAlBxB,WAAkB,QAAlBA,WAAkB;;AACxC,gBAAKyB,aAAL;;AACA,gBAAKf,QAAL,CAAcE,KAAd;;AACA,gBAAKF,QAAL,CAAcC,mBAAd,CAAkCZ,MAAM,CAACC,WAAD,CAAxC;AACD,SARqC;AAStC0B,QAAAA,kBAAkB,EAAE,mCAAqB;AAAA,cAAlB1B,WAAkB,SAAlBA,WAAkB;;AACvC,gBAAKU,QAAL,CAAcC,mBAAd,CAAkCZ,MAAM,CAACC,WAAD,CAAxC;AACD,SAXqC;AAYtC2B,QAAAA,qBAAqB,EAAE;AAAA,cAAG3B,WAAH,SAAGA,WAAH;AAAA,iBAAqBS,KAAK,CAACT,WAAD,CAA1B;AAAA,SAZe;AAatC4B,QAAAA,uBAAuB,EAAE;AAAA,cAAG5B,WAAH,SAAGA,WAAH;AAAA,iBAAqBS,KAAK,CAACT,WAAD,CAA1B;AAAA;AAba,OAApB,CAApB;AAeD,KA1C2B;;AAAA,UA4C5ByB,aA5C4B,GA4CZ,YAAM;AACpB,YAAKI,QAAL,GAAgB,IAAIvC,IAAI,CAACwC,QAAT,EAAhB;;AACA,YAAKC,KAAL,CAAWC,QAAX,CAAoB,MAAKH,QAAzB;AACD,KA/C2B;;AAAA,UAiD5BI,SAjD4B,GAiDhB,UAACC,IAAD,EAAOC,MAAP,EAAeC,SAAf,EAA6B;AACvC,YAAKC,WAAL,CAAiBC,KAAjB;;AACA,UAAMT,QAAQ,GAAGO,SAAS,GAAG,MAAKP,QAAR,GAAmB,MAAKQ,WAAlD;AACAR,MAAAA,QAAQ,CAACU,SAAT,CAAmB,MAAKjC,KAAL,CAAWkC,WAA9B;AACAX,MAAAA,QAAQ,CAACY,SAAT,CAAmB,CAAnB,EAAsB,MAAKnC,KAAL,CAAWkC,WAAjC,EAA8C,MAAKlC,KAAL,CAAWoC,WAAzD;AAEAlD,MAAAA,UAAU,CAAC0C,IAAD,CAAV,CAAiBC,MAAjB,EAAyBN,QAAzB;AAEAA,MAAAA,QAAQ,CAACc,OAAT;;AACA,YAAK5B,QAAL,CAAc6B,OAAd;AACD,KA3D2B;;AAAA,UA6D5BC,qBA7D4B,GA6DJ;AAAA,aAAM,KAAN;AAAA,KA7DI;;AAAA,UA+D5BC,IA/D4B,GA+DrB,YAAM;AACX,UAAI,CAAC,MAAK/B,QAAV,EAAoB;AAClB,eAAO,IAAP;AACD;;AAHU,UAKHgC,QALG,GAKU,MAAKhB,KALf,CAKHgB,QALG;;AAMX,UAAIA,QAAQ,CAACC,MAAT,GAAkB,CAAtB,EAAyB;AACvB,YAAMC,KAAK,GAAGF,QAAQ,CAACA,QAAQ,CAACC,MAAT,GAAkB,CAAnB,CAAtB;;AACA,cAAKjB,KAAL,CAAWmB,WAAX,CAAuBD,KAAvB;;AACA,cAAKlC,QAAL,CAAc6B,OAAd;;AAEA/B,QAAAA,UAAU,CAAC;AAAA,iBAAM,MAAKP,KAAL,CAAWQ,QAAX,IAAuB,MAAKR,KAAL,CAAWQ,QAAX,CAAoB,MAAKC,QAAzB,CAA7B;AAAA,SAAD,EAAkE,CAAlE,CAAV;AACA,eAAOkC,KAAP;AACD;AACF,KA7E2B;;AAAA,UA+E5BX,KA/E4B,GA+EpB,YAAM;AACZ,YAAK5B,QAAL,CAAcE,KAAd;;AACA,UAAI,CAAC,MAAKG,QAAV,EAAoB;AAClB,eAAO,IAAP;AACD;;AAED,UAAI,MAAKgB,KAAL,CAAWgB,QAAX,CAAoBC,MAApB,GAA6B,CAAjC,EAAoC;AAClC,cAAKjB,KAAL,CAAWoB,cAAX;;AACA,cAAKpC,QAAL,CAAc6B,OAAd;AACD;;AAED,aAAO,IAAP;AACD,KA3F2B;;AAAA,UA6F5BrD,iBA7F4B,GA6FR,YAAa;AAAA,wCAAT6D,IAAS;AAATA,QAAAA,IAAS;AAAA;;AAC/B,aAAO7D,iBAAiB,MAAjB,UAAkB,MAAK8D,MAAvB,SAAkCD,IAAlC,EAAP;AACD,KA/F2B;;AAAA,UAiG5BE,eAjG4B,GAiGV,iBAAO/C,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAChB,oBAAKA,OAAL,GAAeA,OAAf;AACA,oBAAK8B,WAAL,GAAmB,IAAI/C,IAAI,CAACwC,QAAT,EAAnB;AAEA,oBAAKC,KAAL,GAAa,IAAIzC,IAAI,CAACiE,SAAT,EAAb;;AACA,oBAAKxB,KAAL,CAAWC,QAAX,CAAoB,MAAKK,WAAzB;;AAEMmB,cAAAA,aAPU,GAOMjD,OAAO,CAACkD,oBAAR,IAAiC;AAAA,uBAAO,EAAP;AAAA,eAPvC;;AAQhBlD,cAAAA,OAAO,CAACkD,oBAAR,GAA+B,YAAM;AACnC,oBAAMC,iBAAiB,GAAGF,aAAa,EAAvC;AACA,uDACKE,iBADL;AAEEC,kBAAAA,OAAO,EAAE;AAFX;AAID,eAND;;AAQA,oBAAK5C,QAAL,GAAgBzB,IAAI,CAACsE,kBAAL,CACdrD,OAAO,CAACsD,kBADM,EAEdtD,OAAO,CAACuD,mBAFM,EAGd;AACEvD,gBAAAA,OAAO,EAAPA,OADF;AAEEwD,gBAAAA,SAAS,EAAE,IAFb;AAGEC,gBAAAA,eAAe,EAAE,QAHnB;AAIEC,gBAAAA,WAAW,EAAE,KAJf;AAKEC,gBAAAA,SAAS,EAAE;AALb,eAHc,CAAhB;;AAWA,oBAAKnD,QAAL,CAAc6B,OAAd,GAAwB,YAAM;AAC5B,sBAAK7B,QAAL,CAAcoD,MAAd,CAAqB,MAAKpC,KAA1B;;AACAxB,gBAAAA,OAAO,CAAC6D,WAAR;AACD,eAHD;;AAIA,oBAAK9D,KAAL,CAAW+D,OAAX,IAAsB,MAAK/D,KAAL,CAAW+D,OAAX,CAAmB9D,OAAnB,CAAtB;;AA/BgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAjGU;;AAAA,UAmI5B+D,QAnI4B,GAmIjB,iBAIL;AAAA,wCAHJtE,WAGI,CAFFuE,MAEE;AAAA,UAFQC,KAER,yBAFQA,KAER;AAAA,UAFeC,MAEf,yBAFeA,MAEf;;AACJ,UAAI,MAAK1D,QAAT,EAAmB;AACjB,YAAMnB,MAAK,GAAGC,UAAU,CAACC,GAAX,EAAd;;AACA,cAAKiB,QAAL,CAAc2D,MAAd,CAAqBF,KAAK,GAAG5E,MAA7B,EAAoC6E,MAAM,GAAG7E,MAA7C;;AACA,cAAKmB,QAAL,CAAc6B,OAAd;AACD;AACF,KA7I2B;;AAAA,UA+I5B+B,MA/I4B,GA+InB,UAAAC,GAAG,EAAI;AACd,YAAKvB,MAAL,GAAcuB,GAAd;AACD,KAjJ2B;;AAG1B,UAAKlE,QAAL,GAAgB,IAAIjB,cAAJ,EAAhB;;AACA,UAAKe,kBAAL;;AAJ0B;AAK3B;;;;yCAEoB;AACnBd,MAAAA,MAAM,CAACC,iBAAP;AACD;;;wCAEmB;AAClB,WAAKkF,QAAL,GAAgB,KAAKnE,QAAL,CAAcoE,WAAd,CAA0BrF,cAAc,CAACsF,eAAzC,EAA0D,KAAK9C,SAA/D,CAAhB;AACD;;;2CAEsB;AACrB,WAAK4C,QAAL,CAAcG,MAAd;AACD;;;6BAkIQ;AACP,aACE,oBAAC,MAAD,eACM,KAAKhE,YAAL,CAAkBiE,WADxB;AAEE,QAAA,QAAQ,EAAE,KAAKX,QAFjB;AAGE,QAAA,GAAG,EAAE,oBAAoB5E,MAAM,CAACC,iBAHlC;AAIE,QAAA,GAAG,EAAE,KAAKgF;AAJZ,SAKM,KAAKrE,KALX;AAME,QAAA,eAAe,EAAE,KAAKgD,eANxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF;AAUD;;;;EAvKoCnE,KAAK,CAAC+F,S;;SAAxB7E,S","sourcesContent":["//@flow\nimport React from 'react';\nimport { GLView } from 'expo-gl';\nimport { PanResponder, PixelRatio } from 'react-native';\nimport { vec2 } from 'gl-matrix';\n\nimport PIXI from '../Pixi';\nimport { takeSnapshotAsync } from '../utils';\nimport { BezierPath, BezierProvider } from '../core/signature';\n\nglobal.__ExpoSignatureId = global.__ExpoSignatureId || 0;\n\ntype Props = {\n  strokeColor: number | string,\n  strokeAlpha: number,\n  onChange: () => PIXI.Renderer,\n  onReady: () => WebGLRenderingContext,\n};\n\nconst scale = PixelRatio.get();\n\nfunction scaled(nativeEvent) {\n  const out = vec2.fromValues(nativeEvent.locationX, nativeEvent.locationY);\n  vec2.scale(out, out, scale);\n  return out;\n}\n\nexport default class Signature extends React.Component<Props> {\n  stage: PIXI.Stage;\n\n  graphics;\n  graphicsTmp;\n\n  panResponder: PanResponder;\n  renderer: PIXI.Renderer;\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.provider = new BezierProvider();\n    this._setupPanResponder();\n  }\n\n  componentWillMount() {\n    global.__ExpoSignatureId++;\n  }\n\n  componentDidMount() {\n    this._drawSub = this.provider.addListener(BezierProvider.EVENT_DRAW_PATH, this._drawPath);\n  }\n\n  componentWillUnmount() {\n    this._drawSub.remove();\n  }\n\n  _setupPanResponder = () => {\n    const onEnd = nativeEvent => {\n      this.provider.addPointToSignature(scaled(nativeEvent), true);\n      this.provider.reset();\n\n      setTimeout(() => this.props.onChange && this.props.onChange(this.renderer), 1);\n    };\n\n    this.panResponder = PanResponder.create({\n      onStartShouldSetResponder: () => true,\n      onStartShouldSetPanResponderCapture: () => true,\n      onMoveShouldSetPanResponder: (evt, gestureState) => true,\n      onPanResponderGrant: ({ nativeEvent }) => {\n        this._beginNewLine();\n        this.provider.reset();\n        this.provider.addPointToSignature(scaled(nativeEvent));\n      },\n      onPanResponderMove: ({ nativeEvent }) => {\n        this.provider.addPointToSignature(scaled(nativeEvent));\n      },\n      onPanResponderRelease: ({ nativeEvent }) => onEnd(nativeEvent),\n      onPanResponderTerminate: ({ nativeEvent }) => onEnd(nativeEvent),\n    });\n  };\n\n  _beginNewLine = () => {\n    this.graphics = new PIXI.Graphics();\n    this.stage.addChild(this.graphics);\n  };\n\n  _drawPath = (type, points, finalized) => {\n    this.graphicsTmp.clear();\n    const graphics = finalized ? this.graphics : this.graphicsTmp;\n    graphics.beginFill(this.props.strokeColor);\n    graphics.lineStyle(1, this.props.strokeColor, this.props.strokeAlpha);\n\n    BezierPath[type](points, graphics);\n\n    graphics.endFill();\n    this.renderer._update();\n  };\n\n  shouldComponentUpdate = () => false;\n\n  undo = () => {\n    if (!this.renderer) {\n      return null;\n    }\n\n    const { children } = this.stage;\n    if (children.length > 0) {\n      const child = children[children.length - 1];\n      this.stage.removeChild(child);\n      this.renderer._update();\n      // TODO: This doesn't really work :/\n      setTimeout(() => this.props.onChange && this.props.onChange(this.renderer), 2);\n      return child;\n    }\n  };\n\n  clear = () => {\n    this.provider.reset();\n    if (!this.renderer) {\n      return null;\n    }\n\n    if (this.stage.children.length > 0) {\n      this.stage.removeChildren();\n      this.renderer._update();\n    }\n\n    return null;\n  };\n\n  takeSnapshotAsync = (...args) => {\n    return takeSnapshotAsync(this.glView, ...args);\n  };\n\n  onContextCreate = async (context: WebGLRenderingContext) => {\n    this.context = context;\n    this.graphicsTmp = new PIXI.Graphics();\n\n    this.stage = new PIXI.Container();\n    this.stage.addChild(this.graphicsTmp);\n\n    const getAttributes = context.getContextAttributes || (() => ({}));\n    context.getContextAttributes = () => {\n      const contextAttributes = getAttributes();\n      return {\n        ...contextAttributes,\n        stencil: true,\n      };\n    };\n\n    this.renderer = PIXI.autoDetectRenderer(\n      context.drawingBufferWidth,\n      context.drawingBufferHeight,\n      {\n        context,\n        antialias: true,\n        backgroundColor: 0xffffff,\n        transparent: false,\n        autoStart: false,\n      }\n    );\n    this.renderer._update = () => {\n      this.renderer.render(this.stage);\n      context.endFrameEXP();\n    };\n    this.props.onReady && this.props.onReady(context);\n  };\n\n  onLayout = ({\n    nativeEvent: {\n      layout: { width, height },\n    },\n  }) => {\n    if (this.renderer) {\n      const scale = PixelRatio.get();\n      this.renderer.resize(width * scale, height * scale);\n      this.renderer._update();\n    }\n  };\n\n  setRef = ref => {\n    this.glView = ref;\n  };\n\n  render() {\n    return (\n      <GLView\n        {...this.panResponder.panHandlers}\n        onLayout={this.onLayout}\n        key={'Expo.Signature-' + global.__ExpoSignatureId}\n        ref={this.setRef}\n        {...this.props}\n        onContextCreate={this.onContextCreate}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}